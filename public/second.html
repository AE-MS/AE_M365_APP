<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <link
      rel="stylesheet"
      href="https://static2.sharepointonline.com/files/fabric/office-ui-fabric-core/11.0.0/css/fabric.min.css"
    />
    <title>Microsoft Teams Tab2</title>
  </head>

  <body>
    <script
    src="https://res.cdn.office.net/teams-js/2.15.0/js/MicrosoftTeams.min.js"
    integrity="sha384-fTDbgjG+RKtC2IyKV3r1o0xdxY4oV1v53uPHwPJTmTddvDm2ats9JWRAbtouZx4C"
    crossorigin="anonymous"
    ></script>
      <script type="text/javascript">
        function addTextToBody(text) {
          var div = document.createElement("div");
          div.textContent = text;
          document.body.appendChild(div);
          console.log(text);
        }

        addTextToBody("CALLING INITIALIZE");
        microsoftTeams.app.initialize().then(() => {
          addTextToBody("INITIALIZED, TRYING TO GET CONTEXT");
          microsoftTeams.app.getContext().then(async (context) => {
            addTextToBody("I HAVE THE CONTEXT")
            addTextToBody(`Client type: ${context.app.host.clientType}`);
          });
          addTextToBody("AFTER GETCONTEXT CALL");
        });
      </script>
  </body></html>
